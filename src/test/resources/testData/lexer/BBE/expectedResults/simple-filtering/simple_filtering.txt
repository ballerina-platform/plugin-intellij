import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('io')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('runtime')
; (';')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// Creates a `record` type that represents the `Person`.')
WHITE_SPACE ('\n')
type ('type')
WHITE_SPACE (' ')
identifier ('Person')
WHITE_SPACE (' ')
record ('record')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('name')
; (';')
WHITE_SPACE ('\n    ')
int ('int')
WHITE_SPACE (' ')
identifier ('age')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('status')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('address')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('phoneNo')
; (';')
WHITE_SPACE ('\n')
} ('}')
; (';')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// Creates a `record` type that represents the `Child`.')
WHITE_SPACE ('\n')
type ('type')
WHITE_SPACE (' ')
identifier ('Child')
WHITE_SPACE (' ')
record ('record')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('name')
; (';')
WHITE_SPACE ('\n    ')
int ('int')
WHITE_SPACE (' ')
identifier ('age')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('city')
; (';')
WHITE_SPACE ('\n')
} ('}')
; (';')
WHITE_SPACE ('\n\n\n')
int ('int')
WHITE_SPACE (' ')
identifier ('index')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('0')
; (';')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// Streams that are based on the constraint types created above.')
WHITE_SPACE ('\n')
stream ('stream')
< ('<')
identifier ('Person')
> ('>')
WHITE_SPACE (' ')
identifier ('personStream')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
new ('new')
; (';')
WHITE_SPACE ('\n')
stream ('stream')
< ('<')
identifier ('Child')
> ('>')
WHITE_SPACE (' ')
identifier ('childrenStream')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
new ('new')
; (';')
WHITE_SPACE ('\n\n')
identifier ('Child')
[ ('[')
] (']')
WHITE_SPACE (' ')
identifier ('globalChildrenArray')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
[ ('[')
] (']')
; (';')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('initFilterQuery')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// Streaming query, which filters events based on the age attribute.')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// Filtered events are pushed to a stream called `childrenStream`.')
WHITE_SPACE ('\n    ')
forever ('forever')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
from ('from')
WHITE_SPACE (' ')
identifier ('personStream')
WHITE_SPACE (' ')
where ('where')
WHITE_SPACE (' ')
identifier ('personStream')
. ('.')
identifier ('age')
WHITE_SPACE (' ')
<= ('<=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('16')
WHITE_SPACE ('\n        ')
select ('select')
WHITE_SPACE (' ')
identifier ('personStream')
. ('.')
identifier ('name')
, (',')
WHITE_SPACE (' ')
identifier ('personStream')
. ('.')
identifier ('age')
, (',')
WHITE_SPACE ('\n                ')
identifier ('personStream')
. ('.')
identifier ('address')
WHITE_SPACE (' ')
as ('as')
WHITE_SPACE (' ')
identifier ('city')
WHITE_SPACE ('\n        ')
=> ('=>')
WHITE_SPACE (' ')
( ('(')
identifier ('Child')
[ ('[')
] (']')
WHITE_SPACE (' ')
identifier ('children')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n            ')
foreach ('foreach')
WHITE_SPACE (' ')
var ('var')
WHITE_SPACE (' ')
identifier ('c')
WHITE_SPACE (' ')
in ('in')
WHITE_SPACE (' ')
identifier ('children')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n                ')
identifier ('childrenStream')
. ('.')
identifier ('publish')
( ('(')
identifier ('c')
) (')')
; (';')
WHITE_SPACE ('\n            ')
} ('}')
WHITE_SPACE ('\n        ')
} ('}')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
public ('public')
WHITE_SPACE (' ')
function ('function')
WHITE_SPACE (' ')
identifier ('main')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Sample events that represent a different person.')
WHITE_SPACE ('\n    ')
identifier ('Person')
[ ('[')
] (']')
WHITE_SPACE (' ')
identifier ('personArray')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
[ ('[')
] (']')
; (';')
WHITE_SPACE ('\n    ')
identifier ('Person')
WHITE_SPACE (' ')
identifier ('t1')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE (' ')
identifier ('name')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Raja"')
, (',')
WHITE_SPACE (' ')
identifier ('age')
: (':')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('12')
, (',')
WHITE_SPACE (' ')
identifier ('status')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"single"')
, (',')
WHITE_SPACE ('\n                    ')
identifier ('address')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Mountain View"')
, (',')
WHITE_SPACE (' ')
identifier ('phoneNo')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"+19877386134"')
WHITE_SPACE (' ')
} ('}')
; (';')
WHITE_SPACE ('\n    ')
identifier ('Person')
WHITE_SPACE (' ')
identifier ('t2')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE (' ')
identifier ('name')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Mohan"')
, (',')
WHITE_SPACE (' ')
identifier ('age')
: (':')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('30')
, (',')
WHITE_SPACE (' ')
identifier ('status')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"single"')
, (',')
WHITE_SPACE ('\n                    ')
identifier ('address')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Memphis"')
, (',')
WHITE_SPACE (' ')
identifier ('phoneNo')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"+198353536134"')
} ('}')
; (';')
WHITE_SPACE ('\n    ')
identifier ('Person')
WHITE_SPACE (' ')
identifier ('t3')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE (' ')
identifier ('name')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Shareek"')
, (',')
WHITE_SPACE (' ')
identifier ('age')
: (':')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('16')
, (',')
WHITE_SPACE (' ')
identifier ('status')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"single"')
, (',')
WHITE_SPACE ('\n                    ')
identifier ('address')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Houston"')
, (',')
WHITE_SPACE (' ')
identifier ('phoneNo')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"+1343434454"')
WHITE_SPACE (' ')
} ('}')
; (';')
WHITE_SPACE ('\n\n    ')
identifier ('personArray')
[ ('[')
DECIMAL_INTEGER_LITERAL ('0')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('t1')
; (';')
WHITE_SPACE ('\n    ')
identifier ('personArray')
[ ('[')
DECIMAL_INTEGER_LITERAL ('1')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('t2')
; (';')
WHITE_SPACE ('\n    ')
identifier ('personArray')
[ ('[')
DECIMAL_INTEGER_LITERAL ('2')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('t3')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Deploys the filter streaming query.')
WHITE_SPACE ('\n    ')
identifier ('initFilterQuery')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// The `childrenStream` subscribes to the `printChildren` function. Whenever the')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// `childrenStream` stream receives a valid event, this function is called.')
WHITE_SPACE ('\n    ')
identifier ('childrenStream')
. ('.')
identifier ('subscribe')
( ('(')
identifier ('printChildren')
) (')')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Simulates the sample event that represents the Person.')
WHITE_SPACE ('\n    ')
foreach ('foreach')
WHITE_SPACE (' ')
var ('var')
WHITE_SPACE (' ')
identifier ('t')
WHITE_SPACE (' ')
in ('in')
WHITE_SPACE (' ')
identifier ('personArray')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('personStream')
. ('.')
identifier ('publish')
( ('(')
identifier ('t')
) (')')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n\n    ')
int ('int')
WHITE_SPACE (' ')
identifier ('count')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('0')
; (';')
WHITE_SPACE ('\n    ')
while ('while')
( ('(')
BOOLEAN_LITERAL ('true')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('runtime')
: (':')
identifier ('sleep')
( ('(')
DECIMAL_INTEGER_LITERAL ('500')
) (')')
; (';')
WHITE_SPACE ('\n        ')
identifier ('count')
WHITE_SPACE (' ')
+= ('+=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('1')
; (';')
WHITE_SPACE ('\n        ')
if ('if')
( ('(')
( ('(')
identifier ('globalChildrenArray')
. ('.')
identifier ('length')
( ('(')
) (')')
) (')')
WHITE_SPACE (' ')
== ('==')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('2')
WHITE_SPACE (' ')
|| ('||')
WHITE_SPACE (' ')
identifier ('count')
WHITE_SPACE (' ')
== ('==')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('10')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n            ')
break ('break')
; (';')
WHITE_SPACE ('\n        ')
} ('}')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('printChildren')
( ('(')
identifier ('Child')
WHITE_SPACE (' ')
identifier ('child')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Child detected. Child name : "')
, (',')
WHITE_SPACE ('\n            ')
identifier ('child')
. ('.')
identifier ('name')
, (',')
WHITE_SPACE ('  ')
QUOTED_STRING_LITERAL ('", age : "')
, (',')
WHITE_SPACE (' ')
identifier ('child')
. ('.')
identifier ('age')
, (',')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('" and from : "')
, (',')
WHITE_SPACE (' ')
identifier ('child')
. ('.')
identifier ('city')
) (')')
; (';')
WHITE_SPACE ('\n    ')
identifier ('addToGlobalChildrenArray')
( ('(')
identifier ('child')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('addToGlobalChildrenArray')
( ('(')
identifier ('Child')
WHITE_SPACE (' ')
identifier ('e')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('globalChildrenArray')
[ ('[')
identifier ('index')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('e')
; (';')
WHITE_SPACE ('\n    ')
identifier ('index')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('index')
WHITE_SPACE (' ')
+ ('+')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('1')
; (';')
WHITE_SPACE ('\n')
} ('}')
