import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('io')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('runtime')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('task')
; (';')
WHITE_SPACE ('\n\n')
int ('int')
WHITE_SPACE (' ')
identifier ('reminderCount')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('0')
; (';')
WHITE_SPACE ('\n\n')
public ('public')
WHITE_SPACE (' ')
function ('function')
WHITE_SPACE (' ')
identifier ('main')
WHITE_SPACE (' ')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// The Appointment data record provides the appointment configurations.')
WHITE_SPACE ('\n    ')
identifier ('task')
: (':')
identifier ('AppointmentData')
WHITE_SPACE (' ')
identifier ('appointmentData')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('seconds')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"0/2"')
, (',')
WHITE_SPACE ('\n        ')
identifier ('minutes')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"*"')
, (',')
WHITE_SPACE ('\n        ')
identifier ('hours')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"*"')
, (',')
WHITE_SPACE ('\n        ')
identifier ('daysOfMonth')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"?"')
, (',')
WHITE_SPACE ('\n        ')
identifier ('months')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"*"')
, (',')
WHITE_SPACE ('\n        ')
identifier ('daysOfWeek')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"*"')
, (',')
WHITE_SPACE ('\n        ')
identifier ('year')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"*"')
WHITE_SPACE ('\n    ')
} ('}')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Create an Appointment using the configurations.')
WHITE_SPACE ('\n    ')
identifier ('task')
: (':')
identifier ('Scheduler')
WHITE_SPACE (' ')
identifier ('appointment')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
new ('new')
( ('(')
{ ('{')
WHITE_SPACE (' ')
identifier ('appointmentDetails')
: (':')
WHITE_SPACE (' ')
identifier ('appointmentData')
WHITE_SPACE (' ')
} ('}')
) (')')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Attach the service to the scheduler and exit if there is an error.')
WHITE_SPACE ('\n    ')
var ('var')
WHITE_SPACE (' ')
identifier ('attachResult')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment')
. ('.')
identifier ('attach')
( ('(')
identifier ('appointmentService')
) (')')
; (';')
WHITE_SPACE ('\n    ')
if ('if')
WHITE_SPACE (' ')
( ('(')
identifier ('attachResult')
WHITE_SPACE (' ')
is ('is')
WHITE_SPACE (' ')
error ('error')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Error attaching the service."')
) (')')
; (';')
WHITE_SPACE ('\n        ')
return ('return')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Start the scheduler and exit if there is an error.')
WHITE_SPACE ('\n    ')
var ('var')
WHITE_SPACE (' ')
identifier ('startResult')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment')
. ('.')
start ('start')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n    ')
if ('if')
WHITE_SPACE (' ')
( ('(')
identifier ('startResult')
WHITE_SPACE (' ')
is ('is')
WHITE_SPACE (' ')
error ('error')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Starting the task is failed."')
) (')')
; (';')
WHITE_SPACE ('\n        ')
return ('return')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n\n    ')
identifier ('runtime')
: (':')
identifier ('sleep')
( ('(')
DECIMAL_INTEGER_LITERAL ('10000')
) (')')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Cancel the appointment.')
WHITE_SPACE ('\n    ')
var ('var')
WHITE_SPACE (' ')
identifier ('result')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('appointment')
. ('.')
identifier ('stop')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n    ')
if ('if')
WHITE_SPACE (' ')
( ('(')
identifier ('result')
WHITE_SPACE (' ')
is ('is')
WHITE_SPACE (' ')
error ('error')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Error occurred while cancelling the task"')
) (')')
; (';')
WHITE_SPACE ('\n        ')
return ('return')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Appointment cancelled."')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// Creating a service on the task Listener.')
WHITE_SPACE ('\n')
service ('service')
WHITE_SPACE (' ')
identifier ('appointmentService')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
service ('service')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// This resource triggers when the appointment is due.')
WHITE_SPACE ('\n    ')
resource ('resource')
WHITE_SPACE (' ')
function ('function')
WHITE_SPACE (' ')
identifier ('onTrigger')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
if ('if')
WHITE_SPACE (' ')
( ('(')
identifier ('reminderCount')
WHITE_SPACE (' ')
< ('<')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('5')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n            ')
identifier ('reminderCount')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('reminderCount')
WHITE_SPACE (' ')
+ ('+')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('1')
; (';')
WHITE_SPACE ('\n            ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Schedule is due - Reminder: "')
WHITE_SPACE (' ')
+ ('+')
WHITE_SPACE (' ')
identifier ('reminderCount')
. ('.')
identifier ('toString')
( ('(')
) (')')
) (')')
; (';')
WHITE_SPACE ('\n        ')
} ('}')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n')
} ('}')
; (';')
