import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('io')
; (';')
WHITE_SPACE ('\n')
import ('import')
WHITE_SPACE (' ')
identifier ('ballerina')
/ ('/')
identifier ('runtime')
; (';')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// Creates a `record` type that represents the `Person`.')
WHITE_SPACE ('\n')
type ('type')
WHITE_SPACE (' ')
identifier ('Person')
WHITE_SPACE (' ')
record ('record')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('name')
; (';')
WHITE_SPACE ('\n    ')
int ('int')
WHITE_SPACE (' ')
identifier ('age')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('status')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('address')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('phoneNo')
; (';')
WHITE_SPACE ('\n')
} ('}')
; (';')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// Creates a `record` type that represents the `Message`.')
WHITE_SPACE ('\n')
type ('type')
WHITE_SPACE (' ')
identifier ('Message')
WHITE_SPACE (' ')
record ('record')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('name')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('address')
; (';')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('message')
; (';')
WHITE_SPACE ('\n')
} ('}')
; (';')
WHITE_SPACE ('\n\n\n')
int ('int')
WHITE_SPACE (' ')
identifier ('index')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('0')
; (';')
WHITE_SPACE ('\n\n')
LINE_COMMENT ('// These are streams that are based on the constraint types created above.')
WHITE_SPACE ('\n')
stream ('stream')
< ('<')
identifier ('Person')
> ('>')
WHITE_SPACE (' ')
identifier ('personStream')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
new ('new')
; (';')
WHITE_SPACE ('\n')
stream ('stream')
< ('<')
identifier ('Message')
> ('>')
WHITE_SPACE (' ')
identifier ('childrenMessageStream')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
new ('new')
; (';')
WHITE_SPACE ('\n\n')
identifier ('Message')
[ ('[')
] (']')
WHITE_SPACE (' ')
identifier ('globalChildrenMessageArray')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
[ ('[')
] (']')
; (';')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('initProjectionQuery')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// This is a streaming query that filters events based on the attribute age')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// and generates a custom message by calling a user-defined function.')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// The filtered events are pushed to a `stream` called `childrenMessageStream`.')
WHITE_SPACE ('\n    ')
forever ('forever')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
from ('from')
WHITE_SPACE (' ')
identifier ('personStream')
WHITE_SPACE (' ')
where ('where')
WHITE_SPACE (' ')
identifier ('personStream')
. ('.')
identifier ('age')
WHITE_SPACE (' ')
<= ('<=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('16')
WHITE_SPACE ('\n        ')
select ('select')
WHITE_SPACE (' ')
identifier ('personStream')
. ('.')
identifier ('name')
, (',')
WHITE_SPACE (' ')
identifier ('personStream')
. ('.')
identifier ('address')
, (',')
WHITE_SPACE ('\n                ')
identifier ('generateChildrenDayWishMessage')
( ('(')
identifier ('personStream')
. ('.')
identifier ('name')
) (')')
WHITE_SPACE (' ')
as ('as')
WHITE_SPACE (' ')
identifier ('message')
WHITE_SPACE ('\n        ')
=> ('=>')
WHITE_SPACE (' ')
( ('(')
identifier ('Message')
[ ('[')
] (']')
WHITE_SPACE (' ')
identifier ('messages')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n            ')
foreach ('foreach')
WHITE_SPACE (' ')
var ('var')
WHITE_SPACE (' ')
identifier ('m')
WHITE_SPACE (' ')
in ('in')
WHITE_SPACE (' ')
identifier ('messages')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n                ')
identifier ('childrenMessageStream')
. ('.')
identifier ('publish')
( ('(')
identifier ('m')
) (')')
; (';')
WHITE_SPACE ('\n            ')
} ('}')
WHITE_SPACE ('\n        ')
} ('}')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('generateChildrenDayWishMessage')
( ('(')
string ('string')
WHITE_SPACE (' ')
identifier ('name')
) (')')
WHITE_SPACE (' ')
returns ('returns')
WHITE_SPACE (' ')
string ('string')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
string ('string')
WHITE_SPACE (' ')
identifier ('template')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
STRING_TEMPLATE_LITERAL_START ('string `')
STRING_TEMPLATE_EXPRESSION_START ('Hi ${')
identifier ('name')
STRING_TEMPLATE_EXPRESSION_END ('}')
STRING_TEMPLATE_TEXT ('!!!')
STRING_TEMPLATE_LITERAL_END ('`')
; (';')
WHITE_SPACE ('\n    ')
return ('return')
WHITE_SPACE (' ')
identifier ('template')
WHITE_SPACE (' ')
+ ('+')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('" , wish you a happy children's day"')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
public ('public')
WHITE_SPACE (' ')
function ('function')
WHITE_SPACE (' ')
identifier ('main')
( ('(')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Sample events that represent a different person.')
WHITE_SPACE ('\n    ')
identifier ('Person')
[ ('[')
] (']')
WHITE_SPACE (' ')
identifier ('personArray')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
[ ('[')
] (']')
; (';')
WHITE_SPACE ('\n    ')
identifier ('Person')
WHITE_SPACE (' ')
identifier ('t1')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE (' ')
identifier ('name')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Raja"')
, (',')
WHITE_SPACE (' ')
identifier ('age')
: (':')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('12')
, (',')
WHITE_SPACE (' ')
identifier ('status')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"single"')
, (',')
WHITE_SPACE ('\n                    ')
identifier ('address')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Mountain View"')
, (',')
WHITE_SPACE (' ')
identifier ('phoneNo')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"+19877386134"')
WHITE_SPACE (' ')
} ('}')
; (';')
WHITE_SPACE ('\n    ')
identifier ('Person')
WHITE_SPACE (' ')
identifier ('t2')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE (' ')
identifier ('name')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Mohan"')
, (',')
WHITE_SPACE (' ')
identifier ('age')
: (':')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('30')
, (',')
WHITE_SPACE (' ')
identifier ('status')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"single"')
, (',')
WHITE_SPACE ('\n                    ')
identifier ('address')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Memphis"')
, (',')
WHITE_SPACE (' ')
identifier ('phoneNo')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"+198353536134"')
} ('}')
; (';')
WHITE_SPACE ('\n    ')
identifier ('Person')
WHITE_SPACE (' ')
identifier ('t3')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE (' ')
identifier ('name')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Shareek"')
, (',')
WHITE_SPACE (' ')
identifier ('age')
: (':')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('16')
, (',')
WHITE_SPACE (' ')
identifier ('status')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"single"')
, (',')
WHITE_SPACE ('\n                    ')
identifier ('address')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"Houston"')
, (',')
WHITE_SPACE (' ')
identifier ('phoneNo')
: (':')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('"+1343434454"')
WHITE_SPACE (' ')
} ('}')
; (';')
WHITE_SPACE ('\n\n    ')
identifier ('personArray')
[ ('[')
DECIMAL_INTEGER_LITERAL ('0')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('t1')
; (';')
WHITE_SPACE ('\n    ')
identifier ('personArray')
[ ('[')
DECIMAL_INTEGER_LITERAL ('1')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('t2')
; (';')
WHITE_SPACE ('\n    ')
identifier ('personArray')
[ ('[')
DECIMAL_INTEGER_LITERAL ('2')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('t3')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Deploys the projection streaming query.')
WHITE_SPACE ('\n    ')
identifier ('initProjectionQuery')
( ('(')
) (')')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// The `childrenMessageStream` subscribes to the `printChildrenMessage()` function. Whenever the')
WHITE_SPACE ('\n    ')
LINE_COMMENT ('// `childrenMessageStream` stream receives a valid event, this function is called.')
WHITE_SPACE ('\n    ')
identifier ('childrenMessageStream')
. ('.')
identifier ('subscribe')
( ('(')
identifier ('printChildrenMessage')
) (')')
; (';')
WHITE_SPACE ('\n\n    ')
LINE_COMMENT ('// Simulates the sample event that represents the `Person`.')
WHITE_SPACE ('\n    ')
foreach ('foreach')
WHITE_SPACE (' ')
var ('var')
WHITE_SPACE (' ')
identifier ('t')
WHITE_SPACE (' ')
in ('in')
WHITE_SPACE (' ')
identifier ('personArray')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('personStream')
. ('.')
identifier ('publish')
( ('(')
identifier ('t')
) (')')
; (';')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n\n    ')
int ('int')
WHITE_SPACE (' ')
identifier ('count')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('0')
; (';')
WHITE_SPACE ('\n    ')
while ('while')
( ('(')
BOOLEAN_LITERAL ('true')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n        ')
identifier ('runtime')
: (':')
identifier ('sleep')
( ('(')
DECIMAL_INTEGER_LITERAL ('500')
) (')')
; (';')
WHITE_SPACE ('\n        ')
identifier ('count')
WHITE_SPACE (' ')
+= ('+=')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('1')
; (';')
WHITE_SPACE ('\n        ')
if ('if')
( ('(')
( ('(')
identifier ('globalChildrenMessageArray')
. ('.')
identifier ('length')
( ('(')
) (')')
) (')')
WHITE_SPACE (' ')
== ('==')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('2')
WHITE_SPACE (' ')
|| ('||')
WHITE_SPACE (' ')
identifier ('count')
WHITE_SPACE (' ')
== ('==')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('10')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n            ')
break ('break')
; (';')
WHITE_SPACE ('\n        ')
} ('}')
WHITE_SPACE ('\n    ')
} ('}')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('printChildrenMessage')
( ('(')
identifier ('Message')
WHITE_SPACE (' ')
identifier ('msg')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('io')
: (':')
identifier ('println')
( ('(')
QUOTED_STRING_LITERAL ('"Child name : "')
, (',')
WHITE_SPACE (' ')
identifier ('msg')
. ('.')
identifier ('name')
, (',')
WHITE_SPACE (' ')
QUOTED_STRING_LITERAL ('" and message : "')
, (',')
WHITE_SPACE (' ')
identifier ('msg')
. ('.')
identifier ('message')
) (')')
; (';')
WHITE_SPACE ('\n    ')
identifier ('addToGlobalChildrenMessageArray')
( ('(')
identifier ('msg')
) (')')
; (';')
WHITE_SPACE ('\n')
} ('}')
WHITE_SPACE ('\n\n')
function ('function')
WHITE_SPACE (' ')
identifier ('addToGlobalChildrenMessageArray')
( ('(')
identifier ('Message')
WHITE_SPACE (' ')
identifier ('e')
) (')')
WHITE_SPACE (' ')
{ ('{')
WHITE_SPACE ('\n    ')
identifier ('globalChildrenMessageArray')
[ ('[')
identifier ('index')
] (']')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('e')
; (';')
WHITE_SPACE ('\n    ')
identifier ('index')
WHITE_SPACE (' ')
= ('=')
WHITE_SPACE (' ')
identifier ('index')
WHITE_SPACE (' ')
+ ('+')
WHITE_SPACE (' ')
DECIMAL_INTEGER_LITERAL ('1')
; (';')
WHITE_SPACE ('\n')
} ('}')
